# 売上テーブル（Sales）の表示と機能のデバッグ手順

## 1. 売上テーブルの表示確認

### 1.1 前提条件
- 複数の顧客が登録されていること
- 各顧客に来店記録があること
- 異なる日付の来店記録があること

### 1.2 Salesタブを開く
1. 画面下部の「Sales」タブをクリック
2. コンソールで以下のログを確認：

```
=== UltrathinkSalesTable RENDER ===
Visits prop: [{...}, {...}, ...]
Number of visits: X
Customers prop: [{...}, {...}, ...]
Number of customers: Y
Filtered visits by all : X
Sorted visits (top 20): 20
Total revenue for displayed visits: XXXXX
```

### 1.3 表示内容の確認
#### 基本表示
- 来店記録が日付の新しい順に表示されているか
- 最大20件まで表示されているか
- 各行に以下が表示されているか：
  - 顧客名
  - 日付（〇日前形式）
  - メモ（ある場合）
  - 売上金額

#### 統計情報
- 画面上部の総売上が正しいか
- 表示されている来店記録の合計と一致するか

## 2. フィルター機能のテスト

### 2.1 期間フィルター
1. 「All Time」ボタンをクリック（デフォルト）
2. 「Last Week」ボタンをクリック
3. 「Last Month」ボタンをクリック

各フィルター適用時のログ：
```
Filtered visits by week : X
Sorted visits (top 20): Y
Total revenue for displayed visits: XXXXX
```

確認ポイント：
- フィルターによって表示件数が変わるか
- 総売上額が更新されるか
- 1週間/1ヶ月以内のデータのみ表示されるか

### 2.2 フィルター切り替えの動作
- フィルターボタンがアクティブ状態を示すか
- アニメーション効果が適用されるか

## 3. インタラクション機能

### 3.1 行のホバー効果
1. 任意の行にマウスを乗せる
2. 以下を確認：
   - 行がハイライトされるか
   - スケールアニメーションが動作するか
   - グラデーション効果が表示されるか

### 3.2 顧客クリック
1. 任意の行をクリック
2. 顧客詳細画面が開くか確認

エラーケース：
```
Customer not found for visit ID 1, customer ID 999
```
- 削除された顧客の来店記録がある場合に表示される

## 4. 表示パフォーマンス

### 4.1 大量データでのテスト
1. 100件以上の来店記録がある状態でテスト
2. 確認ポイント：
   - 表示が20件に制限されているか
   - スクロールがスムーズか
   - フィルター切り替えが高速か

### 4.2 アニメーション
- 各行の表示アニメーション（フェードイン）
- インデックスに応じた遅延（30ms * index）
- 背景のグラデーションアニメーション

## 5. データ整合性の確認

### 5.1 売上金額の計算
1. 表示されている来店記録の金額を手動で合計
2. 画面上部の総売上と一致するか確認

### 5.2 日付の表示
- 「今日」「昨日」「X日前」の表示が正しいか
- タイムゾーンの問題がないか

### 5.3 前回比較
- 各行の売上変化率（パーセンテージ）が正しいか
- 上昇/下降のインジケーターが適切か

## 6. エッジケースのテスト

### 6.1 データがない場合
1. 来店記録が0件の場合
2. 期待される表示：
   - 「No sales data yet」メッセージ
   - 来店記録追加を促すメッセージ

### 6.2 顧客が削除された場合
1. 来店記録がある顧客を削除
2. 売上テーブルでの表示：
   - 顧客名が表示されない、または「不明な顧客」
   - クリックしても反応しない
   - コンソールに警告が表示される

### 6.3 同じ日に複数の来店
1. 同じ顧客が同日に複数回来店した場合
2. すべての記録が表示されるか確認

## 7. UIデザインの確認

### 7.1 レスポンシブデザイン
- モバイル表示でテーブルが適切に表示されるか
- 横スクロールが必要な場合の操作性

### 7.2 ダークテーマ
- 背景のグラデーション効果
- テキストの可読性
- ホバー効果の視認性

## 8. 問題がある場合の確認事項

### 8.1 データが表示されない
- visitsの読み込みが完了しているか
- loadVisitsのログを確認
- フィルター条件が厳しすぎないか

### 8.2 顧客名が表示されない
- customersの読み込みが完了しているか
- 顧客IDとvisitのcustomerIdが一致するか
- 削除された顧客の処理

### 8.3 フィルターが機能しない
- dateFilterの状態更新を確認
- 日付の比較ロジックを確認
- タイムゾーンの問題

## 9. 改善提案

### 9.1 機能追加
- CSV/PDFエクスポート機能
- 詳細な期間指定（カスタム期間）
- ソート機能（金額順、顧客名順）
- ページネーション（20件以上の表示）

### 9.2 UX改善
- 売上の推移グラフ
- 顧客別の集計表示
- 検索・フィルター機能の強化
- リアルタイム更新

### 9.3 パフォーマンス
- 仮想スクロールの実装
- データの遅延読み込み
- メモ化の活用